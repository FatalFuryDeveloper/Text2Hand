<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Quill + PDF con fondo en todas las p치ginas (Cordova compatible)</title>

  <!-- Quill -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 85%;
      margin: 20px auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      padding: 20px;
    }

    #editor {
      height: 600px;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      overflow-y: auto;
      background: #fff;
    }

    .btn-container {
      text-align: right;
      margin-top: 20px;
    }

    button {
      background-color: #1976d2;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #135ba1;
    }

    /* 游빌 Fondo aplicado por CSS que se repite en todas las p치ginas */
    .pdf-wrapper {
      position: relative;
      background-color: white;
      padding: 25mm 20mm;
    }

    .pdf-wrapper::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('resources/img/paper/paper-square.jpg'); /* 丘멆잺 Cambia aqu칤 tu imagen */
      background-size: contain; /* Mantiene proporci칩n */
      background-repeat: repeat-y; /* 游댠 Se repite verticalmente */
      background-position: center top;
      opacity: 0.8; /* Ajusta transparencia si lo deseas */
      z-index: 0;
    }

    .pdf-content {
      position: relative;
      z-index: 1;
    }

    /* Corta autom치ticamente en el PDF */
    .pdf-wrapper {
      page-break-inside: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Editor con QuillJS</h2>
    <div id="toolbar">
      <select class="ql-font"></select>
      <select class="ql-size"></select>
      <button class="ql-bold"></button>
      <button class="ql-italic"></button>
      <button class="ql-underline"></button>
      <button class="ql-list" value="ordered"></button>
      <button class="ql-list" value="bullet"></button>
      <button class="ql-image"></button>
      <button class="ql-link"></button>
    </div>

    <div id="editor">
    </div>

    <div class="btn-container">
      <button id="btnPDF">Descargar PDF</button>
    </div>
  </div>

  <!-- Librer칤as -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <script>
    const quill = new Quill('#editor', {
      theme: 'snow',
      modules: { toolbar: '#toolbar' },
      placeholder: 'Escribe aqu칤 tu texto...'
    });

    document.getElementById("btnPDF").addEventListener("click", () => {
      const contenido = quill.root.innerHTML;

      // 游댳 Crea contenedor con fondo CSS visible en todas las p치ginas
      const wrapper = document.createElement('div');
      wrapper.classList.add('pdf-wrapper');
      wrapper.innerHTML = `<div class="pdf-content">${contenido}</div>`;

      const opt = {
        margin: 0,
        filename: 'documento_fondo_todas_paginas.pdf',
        image: { type: 'jpeg', quality: 1 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
        pagebreak: { mode: ['css', 'legacy'] }
      };

      html2pdf().set(opt).from(wrapper).save();
    });
  </script>
</body>
</html>
